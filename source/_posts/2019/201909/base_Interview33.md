---
title: Interview_总结 (33)
date: 2019-09-19
tags: Interview
toc: true
---

### 笔试总结
    列一下你的笔试题
    
<!-- more -->

#### 问题1
- Q
    * 数据库中最常见的慢查询优化方式是什么
- A
    * 加索引

#### 问题2
- Q
    * 为什么加索引能优化慢查询
- A
    * 因为索引是一种优化查询的数据结构,比如MySQL中的索引是B+树实现的,而B+树就是一种数据结构,可以优化查询速度,可以利用索引快速查找数据,所以能优化查询

#### 问题3
- Q
    * 你知道哪些数据结构可以提高查询速度
- A
    * 哈希表、完全平衡二叉搜索树、B树、B+树等等

#### 问题4
- Q
    * 那这些数据结构既然都能优化查询速度,那MySQL为何选择使用B+树
- A
    * 哈希表
        * 将每个值通过哈希算法生成对应的数组下标进行存储, 当要取出某个值时, 可以通过下标直接取出查询的那一行的值
        * 可以快速的精确查询,但是不支持范围查询
    * 完全平衡二叉搜索树
        * 实际上每个节点都应该有四个部分 : 左指针, 指向左子树; 键值(key); 键值所对应数据的存储地址(data域中的值); 右指针,指向右子树
        * 完全平衡二叉搜索树是有序的,简单的说就是 "左边的小于右边的"
        * 除了根节点之外, 其他节点的查询至少要查询两次,
        * 由于完全平衡二叉搜索树是有序的,所以支持范围查找
    * B树
        * B树中的一个节点可以存储多个元素
    * B+树
        * B+树中的非叶子节点会冗余一份在叶子节点中,并且叶子节点之间用指针相连
- eg
    * 数据库存储数据 ![数据库存储数据](/img/20190919_1.png)
    * 哈希存储数据方式 ![哈希存储数据方式](/img/20190919_2.png)
    * 完全平衡二叉搜索树存储数据方式 ![完全平衡二叉搜索树存储数据方式](/img/20190919_3.png)
    * B树存储数据方式 ![B树存储数据方式](/img/20190919_4.png)
    * B+树存储数据方式 ![B+树存储数据方式](/img/20190919_5.png)
- 总结
    * 优先作为索引的条件 : 更适合从磁盘中读取数据或者能够提高磁盘的IO效率
    * 哈希不支持范围查找可以先忽略
    * 完全平衡二叉搜索树查询张飞时, 产生了四次磁盘IO
        * 从磁盘中取出“曹操”到内存,CPU从内存取出数据进行笔记,“张飞”<“曹操”,取左子树(产生了一次磁盘IO)
        * 从磁盘中取出“周瑜”到内存,CPU从内存取出数据进行笔记,“张飞”>“周瑜”,取右子树(产生了一次磁盘IO)
        * 从磁盘中取出“孙权”到内存,CPU从内存取出数据进行笔记,“张飞”>“孙权”,取右子树(产生了一次磁盘IO)
        * 从磁盘中取出“黄忠”到内存,CPU从内存取出数据进行笔记,“张飞”=“张飞”,找到结果(产生了一次磁盘IO)
    * B树查询张飞时, 产生了三次磁盘IO
        * 从磁盘中取出“曹操”到内存,CPU从内存取出数据进行笔记,“张飞”<“曹操”,取左子树(产生了一次磁盘IO)
        * 从磁盘中取出“周瑜”到内存,CPU从内存取出数据进行笔记,“张飞”>“周瑜”,取右子树(产生了一次磁盘IO)
        * 从磁盘中取出“孙权 张飞”到内存,CPU从内存取出数据进行笔记,“张飞”=“张飞”,找到结果(产生了一次磁盘IO)
    * B+树查询张飞时, 产生了三次磁盘IO,但B+树的优势在于提高了范围查找的效率

#### 问题5
- Q
    * 一个B+树的节点中到底存储多少个元素合适呢
- A
    * B+树中一个节点为一页或页的倍数最为合适.因为如果一个节点的大小小于1页,那么读取这个节点的时候其实也会读出1页,会造成资源的浪费；如果一个节点的大小大于1页,比如1.2页,那么读取这个节点的时候会读出2页,也会造成资源的浪费；所以为了不造成资源的浪费,最后把一个节点的大小控制在1页、2页、3页、4页等倍数页大小最为合适

#### 问题6
- Q
    * MySQL中B+树的一个节点大小为多大
- A
    * 一页,这里说的 "页" 是MySQL自定义的单位(其实和操作系统类似),MySQL的Innodb引擎中一页的默认大小是16K(如果操作系统中一页大小是4K,那么MySQL中1页 = 操作系统中的4页),这样存取数据的时候都是一页一页的获取索引文件中节点数据的




