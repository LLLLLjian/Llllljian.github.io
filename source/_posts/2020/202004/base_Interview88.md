---
title: Interview_总结 (88)
date: 2020-04-02
tags: Interview
toc: true
---

### 面试题
    今日被问傻系列-缓存与数据库不一致怎么解

<!-- more -->

#### 发生的场景
- A
    * ![缓存与数据库不一致示意图](/img/20200402_1.png)
    * (1+2)先一个写请求,淘汰缓存,写数据库
    * (3+4+5)接着立刻一个读请求,读缓存,cache miss,读从库,写缓存放入数据,以便后续的读能够cache hit(主从同步没有完成,缓存中放入了旧数据)
    * (6)最后,主从同步完成

#### 不一致优化
- A
    * ![缓存与数据库不一致解决示意图](/img/20200402_2.png)
    * (6)主从同步
    * (7)通过工具订阅从库的binlog,这里能够最准确的知道,从库数据同步完成的时间
    * (8)从库执行完写操作,向缓存再次发起删除,淘汰这段时间内可能写入缓存的旧数据



