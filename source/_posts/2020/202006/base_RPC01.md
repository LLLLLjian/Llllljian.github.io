---
title: RPC_总结 (01)
date: 2020-06-10
tags: RPC
toc: true
---

### 了解RPC
    了解RPC

<!-- more -->

#### RPC是什么
> RPC(Remote Procedure Call): 远程过程调用, 它是一种通过网络从远程计算机程序上请求服务, 而不需要了解底层网络技术的思想, 

#### RPC能干什么
> 也就是说两台服务器A, B, 一个应用部署在A服务器上, 想要调用B服务器上应用提供的函数/方法, 由于不在一个内存空间, 不能直接调用, 需要通过网络来表达调用的语义和传达调用的数据.

#### RPC工作流程示意图
* 服务消费者(Client 客户端)通过本地调用的方式调用服务.
* 客户端存根(Client Stub)接收到调用请求后负责将方法、入参等信息序列化(组装)成能够进行网络传输的消息体.
* 客户端存根(Client Stub)找到远程的服务地址, 并且将消息通过网络发送给服务端.
* 服务端存根(Server Stub)收到消息后进行解码(反序列化操作).
* 服务端存根(Server Stub)根据解码结果调用本地的服务进行相关处理
* 服务端(Server)本地服务业务处理.
* 处理结果返回给服务端存根(Server Stub).
* 服务端存根(Server Stub)序列化结果.
* 服务端存根(Server Stub)将结果通过网络发送至消费方.
* 客户端存根(Client Stub)接收到消息, 并进行解码(反序列化).
* 服务消费方得到最终结果
![RPC工作流程示意图](/img/20200610_1.png)
![RPC工作流程示意图](/img/20200610_2.png)

#### 完整的RPC框架
1. 客户端(Client): 服务调用方.
2. 客户端存根(Client Stub): 存放服务端地址信息, 将客户端的请求参数数据信息打包成网络消息, 再通过网络传输发送给服务端.
3. 服务端存根(Server Stub): 接收客户端发送过来的请求消息并进行解包, 然后再调用本地服务进行处理.
4. 服务端(Server): 服务的真正提供者.
5. Network Service: 底层传输, 可以是 TCP 或 HTTP
![完整的RPC框架](/img/20200610_3.png)

#### RPC核心之功能实现
1. 服务寻址
2. 数据流的序列化和反序列化
3. 网络传输

#### 总结
> RPC 主要用于公司内部的服务调用, 性能消耗低, 传输效率高, 实现复杂.
HTTP 主要用于对外的异构环境, 浏览器接口调用, App 接口调用, 第三方接口调用等.

- RPC使用场景(大型的网站, 内部子系统较多、接口非常多的情况下适合使用 RPC): 
    * 长链接.不必每次通信都要像 HTTP 一样去 3 次握手, 减少了网络开销.
    * 注册发布机制.RPC 框架一般都有注册中心, 有丰富的监控管理;发布、下线接口、动态扩展等, 对调用方来说是无感知、统一化的操作.
    * 安全性, 没有暴露资源操作.
    * 微服务支持.就是最近流行的服务化架构、服务化治理, RPC 框架是一个强力的支撑




