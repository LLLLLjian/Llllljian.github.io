---
title: MySQL_基础 (47)
date: 2020-07-06
tags: 
    - MySQL 
    - Interview
toc: true
---

### 更好的理解MySQL
    mysql锁技术、MVCC基础、事务的实现

<!-- more -->

#### mysql锁技术
> 当有多个请求来读取表中的数据时可以不采取任何操作, 但是多个请求里有读请求, 又有修改请求时必须有一种措施来进行并发控制.不然很有可能会造成不一致
- 共享锁(shared lock),又叫做"读锁"
    * 读锁是可以共享的, 或者说多个读请求可以共享一把锁读数据, 不会造成阻塞.
- 排他锁(exclusive lock),又叫做"写锁"
    * 写锁会排斥其他所有获取锁的请求, 一直阻塞, 直到写入完成释放锁

#### MVCC基础
> MVCC (MultiVersion Concurrency Control) 叫做多版本并发控制.InnoDB的 MVCC , 是通过在每行记录的后面保存两个隐藏的列来实现的.这两个列, 一个保存了行的创建时间, 一个保存了行的过期时间, 当然存储的并不是实际的时间值, 而是系统版本号

#### 事务
1. 原子性
    * 一个事务必须被视为不可分割的最小工作单位, 一个事务中的所有操作要么全部成功提交, 要么全部失败回滚, 对于一个事务来说不可能只执行其中的部分操作, 这就是事务的原子性
    * 事务的原子性是通过 undo log 来实现的
        * 每条数据变更(insert/update/delete)操作都伴随一条undo log的生成,并且回滚日志必须先于数据持久化到磁盘上
        * 所谓的回滚就是根据回滚日志做逆向操作, 比如delete的逆向操作为insert, insert的逆向操作为delete, update的逆向为update等
2. 持久性
    * 事务一旦提交, 其所作做的修改会永久保存到数据库中, 此时即使系统崩溃修改的数据也不会丢失.
    * 事务的持久性性是通过 redo log 来实现的
3. 隔离性
    * 管理多个并发读写请求的访问顺序.这种顺序包括串行或者是并行
    * 事务的隔离性是通过 (读写锁+MVCC)来实现的
4. 一致性
    * 通过回滚, 以及恢复, 和在并发环境下的隔离做到一致性

