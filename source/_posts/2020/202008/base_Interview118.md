---
title: Interview_总结 (118)
date: 2020-08-18
tags: Interview
toc: true
---

### 高并发
    高并发和大流量解决方案考察点

<!-- more -->

#### 什么是进程、线程、协程
- 进程
    * 进程(Process)是计算机中的程序关于某数据集合上的一次运行活动,是系统进行资源分配和调度的基本单位,是操作系统结构的基础.进程是一个“执行中的程序”
- 进程的三态模型
    * 运行: 进程占用处理器资源；处于此状态的进程的数目小于等于处理器的数目.在没有其他进程可以执行时(如所有进程都在阻塞状态),通常会自动执行系统的空闲进程.
    * 就绪: 进程已获得除处理器外的所需资源,等待分配处理器资源；只要分配了处理器进程就可执行.就绪进程可以按多个优先级来划分队列.例如,当一个进程由于时间片用完而进入就绪状态时,排入低优先级队列；当进程由I/O操作完成而进入就绪状态时,排入高优先级队列.
    * 阻塞: 由于进程等待某种条件(如I/O操作或进程同步),在条件满足之前无法继续执行.该事件发生前即使把处理器资源分配给该进程,也无法运行
- 进程的五态模型
    * 新建态: 对应于进程刚刚被创建是没有被提交的状态,并等待系统完成创建进程的所有必要信息
    * 活跃就绪/静止就绪: 进程在主存并且可被调度的状态; 进程被对换到辅存时的就绪状态,是不能被直接调度的状态,只有当主存中没有活跃就绪态进程,或者是挂起就绪态进程具有更高的优先级,系统将把挂起就绪态进程调回主存并转换为活跃就绪
    * 运行: 
    * 活跃阻塞/静止阻塞: 进程已在主存,一旦等待的事件产生便进入活跃就绪状态; 进程对换到辅存时的阻塞状态,一旦等待的事件产生便进入静止就绪状态
    * 终止态: 进程已经结束运行,回收除进程控制块之外的其他资源,并让其他进程从进程控制块中收集有关信息
- 线程
    * 有时被称为轻量进程(lightweight processes),是程序执行流的最小单元.线程是独立调度和分派的基本单位.一个进程可以有很多线程,每条线程并行执行不同的任务.
- 线程的三态模型
    * 就绪状态: 线程具备运行的所有条件,逻辑上可以运行,在等待处理机.
    * 运行状态: 线程占用处理器正在运行.
    * 阻塞状态: 线程在等待一个事件(如某个信号量),逻辑上不可执行.
- 线程与进程的区别
    1. 进程是资源分配的最小单位,线程是程序执行的最小单位(资源调度的最小单位)
    2. 进程有自己的独立地址空间,每启动一个进程,系统就会为它分配地址空间,建立数据表来维护代码段、堆栈段和数据段,这种操作非常昂贵.而线程是共享进程中的数据的,使用相同的地址空间,因此CPU切换一个线程的花费远比进程要小很多,同时创建一个线程的开销也比进程要小很多.
    3. 线程之间的通信更方便,同一进程下的线程共享全局变量、静态变量等数据,而进程之间的通信需要以通信的方式(IPC)进行.不过如何处理好同步与互斥是编写多线程程序的难点.
    4. 但是多进程程序更健壮,多线程程序只要有一个线程死掉,整个进程也死掉了,而一个进程死掉并不会对另外一个进程造成影响,因为进程有自己独立的地址空间.
- 线程与协程的区别
    1. 一个线程可以多个协程,一个进程也可以单独拥有多个协程
    2. 线程进程都是同步机制,而协程则是异步
    3. 协程能保留上一次调用的状态,每次过程重入时,就相当于进入上一次调用的状态
- 多进程
    * 同一个时间里,同一个计算机系统中如果允许两个或两个以上的进程处于运行状态
- 多线程
    * 线程就是把一个进程分为很多片,每一片都可以是一个独立的流程

#### 异步方式
- 发送方发出一个请求后,不等待接收方响应这个请求,就继续发送下个请求
- 所有来着发送方的请求形成一个队列,接收方处理完成后通知发送方

#### 同步方式
- 指发送方发送请求后,需要等待接收到接收方发回的响应后,才接着发送下一个请求
- 所有的请求在服务器端得到同步,发送方和接收方对请求的处理步调是一致的

#### 阻塞
- 调用结果返回之前,当前线程从运行状态被挂起,一直等到调用结果返回之后,才进行就绪状态,获取CPU后继续执行

#### 非阻塞
- 如果调用结果不能马上返回,当前线程也不会被挂起,而是立即返回执行下一个调用

#### 同步阻塞方式
    发送方向接收方发送请求后,一直等待响应；接收方处理请求是进行的IO操作如果不能马上得到结果,就一直等到返回结果后,才响应发送方,期间不能进行其他工作.
- eg
    * 在超时排队付账时,客户(发送方)想收款员(接收方)付款(发送请求)后需要等待收款员找零,期间不能做其他的事情；而收款员要等待收款机返回结果(IO操作)后才能把零钱取出来交给客户(响应请求),期间也只能等待,不能做其他的事情.这种方式实现简单,但是效率不高.

#### 同步非阻塞方式
    发送方向接收方发送请求后,一直等待响应；接收方处理请求时进行的IO操作如果不能马上得到结果,就立即返回,去做其他事情,但由于没有得到请求处理结果,不响应发送方,发送方一直在等待,一直等IO操作完成后,接收方获得结果响应发送方后,接收方才进入下一次请求过程.在实际中不使用这种方式.

#### 异步阻塞方法
    发送方向接收方发送请求后,不用等待响应,可以继续其他工作；接收方处理请求是进行的IO操作如果不能马上得到结果,就一直等到返回结果后,才响应发送方,期间不能进行其他工作.这种方式在实际中也不使用.

#### 异步非阻塞方式
    发送方向接收方发送请求后,不用等待响应,可以继续其他工作；接收方处理请求时进行的IO操作富国不能马上得到结果,也不等待,而是马上返回去做其他事情.当IO操作完成以后,将完成状态和结果通知接收方,接收方再响应发送方.
- eg
    * 客户(发送方)想收款员(接收方)付款(发送请求)后在等待收款员找零的过程中,还可以做其他事情,比如打电话、聊天等；而收款员在等待收款机处理交易(IO操作)的过程中可以帮助客户将商品打包,当收款机产生结果后,收款员给客户结账(响应请求).在四种方式中,这种方式是发送方和接收方通信效率最高的一种.