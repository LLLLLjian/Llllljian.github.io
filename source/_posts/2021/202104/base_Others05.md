---
title: 杂项_总结 (05)
date: 2021-04-12
tags: Others
toc: true
---

### 查缺补漏
    计算机基础知识

<!-- more -->

#### 进程和线程的区别
1. 进程是系统进行资源分配和调度的独立单位, 每一个进程都有他自己的内存空间和系统资源
2. 进程实现多处理机环境下的进程调度, 分派, 切换时, 都需要花费较大的时间和空间开销
3. 为了提高系统的执行效率, 减少处理机的空转时间和调度切换的时间, 以及便于系统管理, 所以有了线程, 线程取代了进程调度的基本功能
4. 简单来说, 进程作为资源分配的基本单位, 县城作为资源调度的基本单位

#### 为什么要使用多线程
1. 使用多线程的最主要原因是提高系统的资源利用率, 现在CPU基本都是多核的, 如果只用单线程, 那就是只用到了一个核心, 其他的核心就相当于空闲在那里
2. 有任务需要执行时间很长, 异步去处理, 及时返回结果给调用方, 能够提高系统的吞吐量
3. 系统中用到了生产者消费者模式, 会用多个线程去消费队列的消息, 来提高并发度

#### 线程安全
> 当多个线程访问某个方法时, 不管你通过怎样的调用方式、或者说这些线程如何交替地执行, 我们在主程序中不需要去做任何的同步, 这个类的结果行为都是我们设想的正确行为, 那么我们就可以说这个类是线程安全的

#### 死锁
1. 什么是死锁
    * 在两个或多个并发进程中, 如果每个进程持有某种资源而又都等待别的进程释放它或它们现在保持着的资源, 在未改变这种状态之前都不能向前推进, 称这一组进程产生了死锁.通俗地讲, 就是两个或多个进程被无限期地阻塞、相互等待的一种状态
2. 产生死锁的原因
    * 死锁产生的原因主要是：1、 系统资源不足；2、进程推进顺序非法.
    * 产生死锁有四个必要条件：
        * 互斥：一个资源每次只能被一个进程使用
        * 不可抢占进程已获得的资源, 在未使用完之前, 不能强行剥夺
        * 占有并等待一个进程因请求资源而阻塞时, 对已获得的资源保持不放
        * 环形等待若干进程之间形成一种首尾相接的循环等待资源关系
3. 如何避免死锁
    * 设置加锁顺序: 当多个线程需要相同的一些锁, 但是按照不同的顺序加锁, 死锁就很容易发生.如果能确保所有的线程都是按照相同的顺序获得锁, 那么死锁就不会发生
    * 加锁时限: 在尝试获取锁的过程中若超过了这个时限该线程则放弃对该锁请求.若一个线程没有在给定的时限内成功获得所有需要的锁, 则会进行回退并释放所有已经获得的锁, 然后等待一段随机的时间再重试.这段随机的等待时间让其它线程有机会尝试获取相同的这些锁, 并且让该应用在没有获得锁的时候可以继续运行
    * 死锁检测: 每当一个线程获得了锁, 会在线程和锁相关的数据结构中(map、graph等等)将其记下.除此之外, 每当有线程请求锁, 也需要记录在这个数据结构中.当一个线程请求锁失败时, 这个线程可以遍历锁的关系图看看是否有死锁发生



