---
title: MySQL_基础 (79)
date: 2021-09-14
tags: MySQL
toc: true
---

### 更好的理解MySQL
    Mysql事务

<!-- more -->

#### 事务是什么
> 事务是用户定义的一个数据库操作系列, 这些操作要么全做要么全不做, 是一个不可分割的工作单位

#### 事务特性
> ACID
- 原子性(Automatic): 即事务中的操作要么都做, 要么都不做
- 一致性(Consistency): 事务的执行的结果必须是使数据库从一个一致性状态到另一个一致性状态.这里的一致性状态指的是物理和逻辑上的数据库一致性状态.比如一个银行系统内部各个用户直接互相转账, 无论如何转账, 系统内部的金额的总数总是恒定不变的
- 隔离性(Isolation): 一个事务的执行不能被其他事务干扰.即一个事务内部的操作及使用的数据对其他并发事务是隔离的, 并发执行的各个事务之间不能相互干扰
- 持久性(Duration): 一个事务一旦提交, 它对数据库中数据的改变就该是永久性的

#### 并发引发的问题
- 丢失修改
    * 问题描述: 这种问题是最直观, 最不应该发生的, 例如两个事务T1和T2都读入同一数据进行修改, 这样T1提交修改结果后, 随即T2也提交了结果.这样, T2便将T1对数据的修改给覆盖了, 这样就出现了丢失修改的问题了
    * 产生原因: 两个或多个事务都在对同一数据项进行写操作
- 不可重复读
    * 问题描述: 事务T1读取了某个数据项A, 在事务T1运行期间又有其他事务例如T2对数据项A进行了修改并提交了, 这样事务T1再次读取数据项A的时候, 发现结果不一致了.
    * 产生原因: 一个事务在对某一个数据项进行读操作, 而另外的其他事务对该数据项进行了写操作.
- 读脏数据
    * 问题描述: 事务T1正在修改某个数据项A, 事务还未提交, 而事务T2读取了数据项A, 但是随后事务T1由于某种原因回滚了事务(并未提交事务), 此时事务T2读取到的数据项A的值和数据库中的值是不一致的, 称事务T2读了脏数据(Read Dirty)
    * 产生原因: 一个事务在对某一个数据项进行写操作, 而另外的其他事务对该数据项进行了读操作
- 幻读
    * 问题描述: 事务T1按照某些条件从数据库中查询了一些数据记录, 但是在事务T1执行过程中, 事务T2插入或者删除了某些数据记录, 这样当事务T1再一次按照同样的条件从数据库查询的时候, 发现多了或者少了某些记录.幻读本质上属于不可重复读, 这里为了隔离级别作对照, 所以将其单独划出来作为幻读
    * 产生原因: 由于事务T1按条件对数据表中的很多数据项查询的时候, 这时候其他事务T2对数据表进行了其他数据项的写操作(插入、修改或者删除)

#### 事务隔离级别
- SERIALIZABLE(可串行化)可避免脏读、不可重复读、幻读情况的发生
- REPEATABLE READ(可重复读)可避免脏读、不可重复读情况的发生
- READ COMMITTED(读已提交)可避免脏读情况发生
- READ UNCOMMITTED(读未提交)最低级别, 以上情况均无法保证

